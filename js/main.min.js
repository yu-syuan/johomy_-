/*
	Miya紅利館JS整理
 */
//20170724新增-兌換清單用(刪除商品及顯示需填寫資訊)
// 20170731新增-商品件數計算
$(function() {
  //點擊刪除鍵 刪除商品 商品件數計算 
  $(".ProdDelete").click(function(){
    var C = parseInt($(".pieces_wrap").length); //宣告C為當前商品的件數
    $("#pieces").html(C);
    if(confirm("是否要將此商品移除?")){ //確認是否要刪除商品
      $(this).parents("#ProdDelete").remove(); //按確定就刪除
      C -= 1; //件數-1
    } else {
      return false; //按取消就停止動作
    }
    $("#pieces").html(C);
  });
  //勾選索取三聯式發票 顯示需填寫資訊
  $(".Show_information").hide();
  $("#get_invoice").click(function(){
    $(".Show_information").toggle(300);
  });
});
//20170727新增-數量加減點擊
//20170728新增-點擊數量後有計算功能
//20170729新增-兌換使用點數計算
$(function() {
  $(".remind_color").hide(); //網頁一出現時先隱藏警示文字
  //增加按鈕設定
  $(".addition").click(function(){ 
    $(".remind_color").hide(); //當出現警示時，隱藏警示文字
    var sn = $(this).siblings(".price").attr("sn"); //宣告sn為當前有class="price"裡sn的值
    var num = $(this).siblings(".Quantity"); //宣告當前num為當前class="Quantity"的值
    var pri = $(this).siblings(".price").attr("unit_price"); //宣告單價為當前unit_price的值
    if (parseInt(num.val()) < 10) { //如果值小於10時做+1的動作
      num.val(parseInt(num.val())+1); 
    } else { //否則顯示警示
      $(this).siblings(".remind_color").show();
    }
    //在id="point_?"顯示num*單價的值
    $("#point_"+sn).html(num.val()*pri);
    setTotal();
  });
  //減少按鈕設定
  $(".cut_back").click(function(){
    $(".remind_color").hide(); //當出現警示時，隱藏警示文字
    var sn = $(this).siblings(".price").attr("sn"); //宣告sn為當前有class="price"裡sn的值
    var num = $(this).siblings(".Quantity"); //宣告當前num為當前class="Quantity"的值
    var pri = $(this).siblings(".price").attr("unit_price"); //宣告單價為當前unit_price的值
    if (parseInt(num.val()) > 1) { //如果值大於1時做-1的動作
      num.val(parseInt(num.val())-1)
    } else { //否則顯示警示
      //$(this).siblings(".remind_color").show();
    }
    //在id="point_?"顯示num*單價的值
    $("#point_"+sn).html(num.val()*pri);
    setTotal();
  });
});
//兌換使用點數計算
function setTotal(){
  var member_point = 0;
  var exchange_point = 0;
  //var A = 0;
  //var B = 0;
  member_point = $("#hold_points").attr("hold_points");
  //A = parseInt($("#point_a").html());
  //B = parseInt($("#point_b").html());
  $(".points").each(function(){
    exchange_point += parseInt($(this).text());
  });
  $("#point_totals").html(exchange_point);
  $("#remaining_points").html(member_point - exchange_point);
}
